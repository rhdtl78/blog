<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Jeonghun Kong&#39;s Devlog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Jeonghun Kong&#39;s Devlog Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Jeonghun Kong&#39;s Devlog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Jeonghun Kong&#39;s Devlog Atom Feed"><title data-react-helmet="true">Spring boot TDD | Jeonghun Kong&#x27;s Devlog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://rhdtl78.github.io/study/spring/auto-monitor"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Spring boot TDD | Jeonghun Kong&#x27;s Devlog"><meta data-react-helmet="true" name="description" content="Spring Boot + JPA + JUnit + Mockito"><meta data-react-helmet="true" property="og:description" content="Spring Boot + JPA + JUnit + Mockito"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2020-07-16T00:00:00.000Z"><meta data-react-helmet="true" property="article:tag" content="Spring,Springboot,TDD,Mockito"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://rhdtl78.github.io/study/spring/auto-monitor"><link data-react-helmet="true" rel="alternate" href="https://rhdtl78.github.io/study/spring/auto-monitor" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://rhdtl78.github.io/study/spring/auto-monitor" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d0ecee25.css">
<link rel="preload" href="/assets/js/runtime~main.a5b0cd21.js" as="script">
<link rel="preload" href="/assets/js/main.53cff753.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://github.com/rhdtl78.png" alt="Devlog Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="https://github.com/rhdtl78.png" alt="Devlog Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Devlog</b></a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/cv">CV</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/rhdtl78" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ğŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ğŸŒ</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/study/object/chapter/09">[ì˜¤ë¸Œì íŠ¸] Chapter09. ìœ ì—°í•œ ì„¤ê³„</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/study/object/chapter/07">[ì˜¤ë¸Œì íŠ¸] Chapter07. ê°ì²´ ë¶„í•´</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/study/object/chapter/06">[ì˜¤ë¸Œì íŠ¸] Chapter06. ë©”ì‹œì§€ì™€ ì¸í„°í˜ì´ìŠ¤</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/study/object/chapter/05">[ì˜¤ë¸Œì íŠ¸] Chapter05. ì±…ì„ í• ë‹¹í•˜ê¸°. - GRASP Pattern</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/study/object/chapter/03">[ì˜¤ë¸Œì íŠ¸] Chapter03. ì—­í• , ì±…ì„, í˜‘ë ¥.</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_GeHD" itemprop="headline">Spring boot TDD</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2020-07-16T00:00:00.000Z" itemprop="datePublished">July 16, 2020</time> Â· <!-- -->13 min read</div></header><div class="markdown" itemprop="articleBody"><ol><li><p>ê°œìš”</p><ul><li>Spring Boot ìŠ¤í„°ë””ë¥¼ ìœ„í•œ í”„ë¡œì íŠ¸ë¡œ AutoMonitorë¥¼ ê°œë°œ.</li><li>Mockitoë¥¼ Springboot í™˜ê²½ì—ì„œ TDDë°©ë²•ë¡ ìœ¼ë¡œ ì ‘ê·¼í•´ ì‚¬ìš©í•´ë³´ëŠ” ê²ƒì´ í•™ìŠµ ëª©í‘œ.</li><li>ê¶ê·¹ì ìœ¼ë¡œ, CI/CD Tool (e.g. jenkins) ë¥¼ í™œìš©í•˜ì—¬ ìë™í™” í•˜ëŠ” ê²ƒì´ ê°œë°œ ëª©í‘œ.</li></ul><p>AutoMonitorë€?</p><ul><li>Api Testing Application</li><li>ì£¼ì–´ì§„ APIê°€ ì£¼ì–´ì§„ payloadë¡œ ì •ìƒ ì‘ë™í•˜ëŠ”ê°€ë¥¼ í™•ì¸</li><li>API Health checking</li></ul><p>Stack</p><ul><li>Kotlin</li><li>Springboot</li><li>JPA</li><li>Junit</li><li>Mockito</li><li>Hibernate</li><li>JPA</li><li>Vue</li></ul><p>í•™ìŠµ ì „ëµ</p><ul><li>TDD (Test Driven Development)</li><li>ë ˆì´ì–´ ë³„ë¡œ Mock-up</li><li>í•­ìƒ Test Caseë¥¼ ë¨¼ì € ì‘ì„±í•  ê²ƒ</li></ul><p>í™˜ê²½ ì„¤ì •ì— ëŒ€í•œ ì„¤ëª…ì€ ìƒëµ.</p></li><li><p>Test Driven Development</p><p>TDDë€? </p><blockquote><p>í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ(Test-driven development TDD)ì€ ë§¤ìš° ì§§ì€ ê°œë°œ ì‚¬ì´í´ì„ ë°˜ë³µí•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ í”„ë¡œì„¸ìŠ¤ ì¤‘ í•˜ë‚˜ì´ë‹¤.
ê°œë°œìëŠ” ë¨¼ì € ìš”êµ¬ì‚¬í•­ì„ ê²€ì¦í•˜ëŠ” ìë™í™”ëœ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•œë‹¤. ê·¸ëŸ° í›„ì—, ê·¸ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ í†µê³¼í•˜ê¸° ìœ„í•œ ìµœì†Œí•œì˜ ì½”ë“œë¥¼ ìƒì„±í•œë‹¤.
ë§ˆì§€ë§‰ìœ¼ë¡œ ì‘ì„±í•œ ì½”ë“œë¥¼ í‘œì¤€ì— ë§ë„ë¡ ë¦¬íŒ©í† ë§í•œë‹¤.
ì´ ê¸°ë²•ì„ ê°œë°œí–ˆê±°ë‚˜ &#x27;ì¬ë°œê²¬&#x27; í•œ ê²ƒìœ¼ë¡œ ì¸ì •ë˜ëŠ” Kent Beckì€ 2003ë…„ì— TDDê°€ ë‹¨ìˆœí•œ ì„¤ê³„ë¥¼ ì¥ë ¤í•˜ê³  ìì‹ ê°ì„ ë¶ˆì–´ë„£ì–´ì¤€ë‹¤ê³  ë§í•˜ì˜€ë‹¤.
-- Wikiì—ì„œ ë°œì·Œ <a href="https://ko.wikipedia.org/wiki/%ED%85%8C%EC%8A%A4%ED%8A%B8_%EC%A3%BC%EB%8F%84_%EA%B0%9C%EB%B0%9C" target="_blank" rel="noopener noreferrer">ë§í¬</a></p></blockquote><p>ì£¼ëª©í•  ê²ƒì€ &#x27;ë¨¼ì € ìš”êµ¬ì‚¬í•­ì„ ê²€ì¦í•˜ëŠ” ìë™í™”ëœ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•œë‹¤.&#x27; ì´ë‹¤.
í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ìì²´ê°€ ê¸°ëŠ¥ ëª…ì„¸ê°€ ë˜ê³ , í”„ë¡œê·¸ë¨ì˜ ì²­ì‚¬ì§„ì´ ëœë‹¤.</p><ol><li><p>JPA Repository Mocking</p><p>í…ŒìŠ¤íŠ¸ì˜ ëª©ì ì€ ì‘ì„±í•œ Entityë¥¼ ì‚¬ìš©í•œ JpaRepositoryë¥¼ Mock-up í•´ë³´ê¸° ìœ„í•¨ì´ë‹¤.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/* Test Case */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@RunWith(MockitoJUnitRunner::class) // Mockito runner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ApiSpecJpaRepositoryTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lateinit var apiSpecJpaRepository: ApiSpecJpaRepository; // jpaRepositoryë¥¼ Mockitoë¡œ Mock-up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @InjectMocks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lateinit var apiSpecRepository: ApiSpecRepository; // jpaRepositoryë¥¼ ì´ìš©í•œ Respository. apiSpecJpaRepositoryë¥¼ ì˜ì¡´ ê°ì²´ë¡œ ê°–ëŠ”ë‹¤.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @BeforeAll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun setUp() { // Mockitoì˜ ì–´ë…¸í…Œì´ì…˜ì„ ì‹¤í–‰.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MockitoAnnotations.initMocks(this);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/* JPA Repository */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">interface ApiSpecJpaRepository: JpaRepository&lt;ApiSpec, Long&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/* Repository */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ApiSpecRepository(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val jpaApiSpecRepository: ApiSpecJpaRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>MockitoRunnerê°€ ì˜ì¡´ì„±ì„ ì£¼ì…í•´ì£¼ë©° Mock-upì„ ë§Œë“¤ì–´ ì¤€ë‹¤. ìœ„ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì—ì„œëŠ” apiSpecJpaRepositoryê°€ Mock-up ê°ì²´ê°€ ë˜ë©° ì´ë¥¼ apiSpecRepositoryê°€ ì‚¬ìš©í•œë‹¤.</p><p>ë“±ë¡ëœ APIë¥¼ ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê³ ì í•œë‹¤. ì´ ë•Œ, Respositoryì— í•´ë‹¹ ê¸°ëŠ¥ì„ ë°”ë¡œ êµ¬í˜„í•˜ì§€ ì•Šê³ , ì¸í„°í˜ì´ìŠ¤ë§Œ ë†“ì•„ë‘”ë‹¤.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/* Repository */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ApiSpecRepository(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val jpaApiSpecRepository: ApiSpecJpaRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      * ë“±ë¡ëœ api ëª©ë¡ ê°€ì ¸ì˜¤ê¸°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun getApis(page: Int): List&lt;ApiSpec&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return listOf();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ê·¸ë¦¬ê³  ë°”ë¡œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•œë‹¤.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">/* Test Case */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ApiSpecJpaRepositoryTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private fun mockResultList(size: Long): List&lt;ApiSpec&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return LongStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .range(0, size)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .mapToObj {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    val mocked = mock&lt;ApiSpec&gt;(); // Mock-up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Data mocking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    whenever(mocked.id).thenReturn(it + 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    whenever(mocked.alias).thenReturn(&quot;Test Api - ${it + 1}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    whenever(mocked.url).thenReturn(&quot;/api/v1/test/${it + 1}&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    whenever(mocked.payload).thenReturn(&quot;{ \&quot;data\&quot;: { \&quot;number\&quot;: ${it + 1} } }&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    mocked;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .toList();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    * ì²« í˜ì´ì§€ì— í•´ë‹¹í•˜ëŠ” API ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¨ë‹¤.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun getApis_í˜ì´ì§€_ë²ˆí˜¸ë¡œ_ì¡°íšŒí•˜ê¸°() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // when</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val page: Int = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val recordSize: Int = 12;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val paging = PageRequest.of(page, recordSize);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // mocking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val mockedResults = mockResultList(12)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val mockedPage = PageImpl&lt;ApiSpec&gt;(mockedResults)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        whenever(apiSpecJpaRepository.findAll(paging))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .thenReturn(mockedPage);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertEquals(12, apiSpecRepository.getApis(page).size);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ì—¬ê¸°ì„œ ì£¼ëª©í•  ê²ƒì€ mockResultListì™€ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì˜ mockingë°©ë²•ì´ë‹¤.</p><p>mockResultListëŠ” integerë¥¼ ì¸ìë¡œ ë°›ì•„ ê·¸ ê°’ì„ í¬ê¸°ë¡œ ê°–ëŠ” ApiSpecì˜ Mock-up ê°ì²´ì˜ Listë¥¼ ë°˜í™˜í•œë‹¤.</p><p>ë°ì´í„°ë“¤ì€ ì‹¤ì œ ê°’ì„ ì§ì ‘ ë°”ì¸ë“œ í•˜ì§€ ì•Šê³ , Mockitoì˜ wheneverë¡œ Mock-up ë°ì´í„°ë¥¼ ìƒì„±í•œë‹¤.</p><p>í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì—ì„œëŠ” apiSpecJpaRepository.findAll ì˜ ê²°ê³¼ë¥¼ mock-up í•œë‹¤.</p><p>apiSpecJpaRepositoryì˜ findAll í•¨ìˆ˜ì— PageRequest ì¸ìë¥¼ ë„˜ê²¨ì£¼ì–´ ì‹¤í–‰í•˜ë©´ 12ê°œì˜ ì›ì†Œë¥¼ ê°€ì§„ Listê°ì²´ê°€ ë°˜í™˜ëœë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.</p><p>ë¬¼ë¡  ë°ì´í„°ëŠ” ëª¨ë‘ Mock-upëœ ìƒíƒœì´ë‹¤.</p><p>í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ë©´ ë‹¹ì—°íˆ í†µê³¼í•˜ì§€ ëª»í•œë‹¤. apiSpecRepositoryì—ì„œ í…ŒìŠ¤íŠ¸í•˜ë ¤ëŠ” getApisê°€ ì˜ë¯¸ì—†ëŠ” ë°˜í™˜ì„ í•˜ê³ ìˆê¸° ë•Œë¬¸ì´ë‹¤.</p><p>ì´ì œ ì´ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ í†µê³¼í•˜ê¸° ìœ„í•´ ApiSpecRepositoryì˜ getApisí•¨ìˆ˜ë¥¼ ë§ˆì € êµ¬í˜„í•œë‹¤.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@Repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ApiSpecRepository(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val jpaApiSpecRepository: ApiSpecJpaRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val recordSize: Int = 12;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     * ë“±ë¡ëœ api ëª©ë¡ ê°€ì ¸ì˜¤ê¸°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun getApis(page: Int): List&lt;ApiSpec&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val paging = PageRequest.of(page, recordSize);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val result: Page&lt;ApiSpec&gt;? = jpaApiSpecRepository.findAll(paging);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (result != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return result.content;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return listOf();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>PageRequestë¥¼ ì´ìš©í•´ ì¿¼ë¦¬ ê²°ê³¼ë¥¼ ì œí•œí•˜ë©°, ë°˜í™˜í•  ë‚´ìš©ì€ ëª¨ë‘ Listë¡œ ë³€í™˜í•œë‹¤.</p><p>ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ë‹¤ì‹œ ìˆ˜í–‰í•˜ë©´ í†µê³¼í•  ê²ƒì´ë‹¤. í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•  ìˆ˜ ìˆëŠ” ì´ìœ ëŠ” ë°”ë¡œ apiSpecJpaRepositoryê°€ Mock-up ë˜ì—ˆê¸° ë•Œë¬¸ì´ë‹¤.</p><p>Mockito Test Runnerê°€ @Mockìœ¼ë¡œ ì§€ì •ëœ í•„ë“œë¥¼ Mock-upí•´ë‘ê³ , Mock-upëœ apiSpecJpaRepositoryë¥¼ @InjectMocksë¡œ ì§€ì •ëœ apiSpecRepositoryì— ì˜ì¡´ì„± ì£¼ì…ì„ ì‹¤í–‰í•œë‹¤. ë”°ë¼ì„œ apiSpecRepository ë‚´ë¶€ì—ëŠ” Mock-upëœ jpaRepositoryê°€ ìœ„ì¹˜í•˜ê²Œ ë˜ë©° ë‚´ë¶€ì—ì„œ apiSpecJpaRepositoryë¥¼ í†µí•´ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.</p><p>ë˜í•œ, ë‚´ë¶€ì˜ í•¨ìˆ˜ë¥¼ wheneverë¡œ Mock-upí–ˆê¸° ë•Œë¬¸ì— ì‹¤ì œ Databaseì— ì¿¼ë¦¬ë¥¼ ì§ˆì˜í•˜ì§€ ì•Šê³  ê¸°ëŠ¥ì´ ë™ì‘ í•  ìˆ˜ ìˆì—ˆë‹¤.</p><p>ì´ëŸ° ë°©ë²•ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ë¨¼ì € ì‘ì„±í•˜ê³ , í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ê³ , ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸ì— ëŒ€í•´ ë¦¬íŒ©í„°ë§ì„ ì§„í–‰í•˜ëŠ” ê²ƒì´ TDDì˜ ê¸°ë³¸ì´ë‹¤.</p></li><li><p>Repository Test</p><p>Repository Testì—ì„œëŠ” ë°ì´í„°ì˜ ì €ì¥, ì¡°íšŒê°€ ë‚´ê°€ ì˜ë„í•œ ëŒ€ë¡œ ì´ë¤„ì§€ëŠ”ì§€ë¥¼ í™•ì¸í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë³„ë„ì˜ Mock-upì„ ë§Œë“¤ì§€ ì•ŠëŠ”ë‹¤.
ê°„ë‹¨í•˜ê²Œ Save-Load Testë¥¼ ìˆ˜í–‰í•œë‹¤.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@RunWith(SpringRunner::class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@TestInstance(TestInstance.Lifecycle.PER_CLASS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ApiSpecRepositoryTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lateinit var apiSpecRepository: ApiSpecRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @BeforeAll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun setUp() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (i: Int in 1..60) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            val data = ApiForm(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    url = &quot;http://localhost/api/v1/test/$i&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    alias = &quot;TestApi - $i&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    payload = &quot;{ data: [] }&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            apiSpecRepository.saveApi(data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @AfterAll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun cleanUp() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        apiSpecRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .jpaApiSpecRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .deleteAll();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ìš°ì„  setupê³¼ cleanUpì„ êµ¬ì„±í•œë‹¤. í…ŒìŠ¤íŠ¸ ì‹œì‘ ì „ì— ë°ì´í„°ë¥¼ ë¯¸ë¦¬ êµ¬ì„±í•´ ë‘ê³ , ì´í›„ì—” í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•œ ëª¨ë“  ë°ì´í„°ë¥¼ ëª¨ë‘ ì œê±°í•œë‹¤.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@RunWith(SpringRunner::class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@TestInstance(TestInstance.Lifecycle.PER_CLASS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ApiSpecRepositoryTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun `saveApi - ìƒˆë¡œìš´ API ë“±ë¡`() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // mocking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val inputData = ApiForm(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                url = &quot;http://test/api/v1/mocked&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                alias = &quot;test&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                payload = &quot;{ \&quot;data\&quot; : \&quot;test\&quot; }&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val inserted = apiSpecRepository.saveApi(inputData);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val result = apiSpecRepository.jpaApiSpecRepository.findById(inserted.id!!).get();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Assertions.assertEquals(inputData.url, result.url);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Assertions.assertEquals(inputData.alias, result.alias);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Assertions.assertEquals(inputData.payload, result.payload);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Save í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ë°ì´í„°ë¥¼ ë„£ì–´ë³´ê³ , ì´ë¥¼ ë‹¤ì‹œ êº¼ë‚´ì–´ í™•ì¸í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í–ˆë‹¤.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@RunWith(SpringRunner::class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@TestInstance(TestInstance.Lifecycle.PER_CLASS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ApiSpecRepositoryTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun `getApi - ë‹¨ê±´ ì¡°íšŒ`() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // when</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val id : Long = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val result = apiSpecRepository.getApi(id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Assertions.assertNotNull(result);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Assertions.assertEquals(result!!.id!!, id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Load Testì—ì„  ê¸°ì¡´ ì¤€ë¹„í•œ ë°ì´í„°ë¥¼ êº¼ë‚´ë³´ëŠ” ë°©í–¥ìœ¼ë¡œ ì§„í–‰í–ˆë‹¤.</p></li><li><p>Controller Test
Controller TestëŠ” ì•ì„œì„œ ë§Œë“  Repositoryë¥¼ Mock-Upí•´ì„œ ì§„í–‰í•œë‹¤. Controller Testì˜ ëª©ì ì€ ë§¤í•‘ëœ í•¨ìˆ˜ë“¤ì´ ì œëŒ€ë¡œ ë™ì‘ í•˜ëŠ”ì§€ë¥¼ ë³´ê¸° ìœ„í•¨ì´ì§€ ë°ì´í„°ë¥¼ êº¼ë‚´ì˜¤ëŠ” ê²ƒì´ ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ” ê²ƒì„ ë³´ëŠ” ê²ƒì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì´ë‹¤. ê´€ì‹¬ì‚¬ë¥¼ ìƒê°í•´ì„œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì™€ Mock-Up ë²”ìœ„ë¥¼ ê²°ì •í•œë‹¤.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@RunWith(MockitoJUnitRunner::class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@AutoConfigureMockMvc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@TestInstance(TestInstance.Lifecycle.PER_CLASS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class DashboardControllerTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Mock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lateinit var apiSpecRepository: ApiSpecRepository;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @InjectMocks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lateinit var dashboardController: DashboardController;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Before</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun setUp() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MockitoAnnotations.initMocks(this);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private fun mockResultList(size: Long): List&lt;ApiSpec&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return LongStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .range(0, size)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .mapToObj {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ApiSpec(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            id = it + 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            alias = &quot;Test Api - ${it + 1}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            url = &quot;/api/v1/test/${it + 1}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            payload = &quot;{ \&quot;data\&quot;: { \&quot;number\&quot;: ${it + 1} } }&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .toList();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ìš°ì„  í…ŒìŠ¤íŠ¸ ì¤€ë¹„ë¥¼ ìœ„ì™€ ê°™ì´ í•´ë‘”ë‹¤. ì‹¤ì œ Requestë¥¼ ì£¼ê³  ë°›ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ í•  ê²ƒì´ê¸° ë•Œë¬¸ì— MockMVCë¥¼ ì‚¬ìš©í•œë‹¤. ì•ì„œì„œ ì–¸ê¸‰í•œ ëŒ€ë¡œ apiSpecRepositoryëŠ” Mock-UPí•´ ë‘ê³  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë§ˆë‹¤ ì˜ˆìƒ ê°’ì„ ì •í•œë‹¤. í…ŒìŠ¤íŠ¸ ë°ì´í„°ëŠ” ì—”í‹°í‹°ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤. JpaRepositoryí…ŒìŠ¤íŠ¸ì™€ ë‹¤ë¥¸ ì ì€ ë°ì´í„° ìì²´ë¥¼ ë‹¤ì‹œ Mockitoë¡œ Mock-Upí•˜ì§€ ì•Šì€ ê²ƒì´ë‹¤. Object De/Serializeì—ì„œ Mock-upê°ì²´ì˜ ë‹¤ë¥¸ ë©”ì„œë“œ, í”„ë¡œí¼í‹°ë“¤ì´ í•¨ê»˜ ê²°ê³¼ì— í¬í•¨ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë°ì´í„°ë¥¼ ì§ì ‘ êµ¬ì„±í•˜ê²Œ í–ˆë‹¤.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@RunWith(MockitoJUnitRunner::class)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@AutoConfigureMockMvc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@TestInstance(TestInstance.Lifecycle.PER_CLASS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class DashboardControllerTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun `getRegisteredApis - API Calling í…ŒìŠ¤íŠ¸ - ë°ì´í„° ì¡°íšŒ`() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val mockedList = mockResultList(12)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        whenever(apiSpecRepository.getApis(1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .thenReturn(mockedList);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val request = get(&quot;/api/v1/apis/1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .accept(MediaType.APPLICATION_JSON);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MockMvcBuilders</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .standaloneSetup(dashboardController)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .perform(request)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .andExpect(status().isOk)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .andDo(ResultHandler {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    println(it.response.contentAsString);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .andExpect(jsonPath(&quot;$&quot;).isArray)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .andExpect(jsonPath(&quot;$.*&quot;, Matchers.hasSize&lt;ApiSpec&gt;(12)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ì¡°íšŒ í…ŒìŠ¤íŠ¸ì´ë‹¤. Mock-Up ë°ì´í„°ë¥¼ 12ê°œ (1 page ë¶„ëŸ‰)ì„ ì¤€ë¹„í•´ë‘ê³  í˜ì´ì§€ ë²ˆí˜¸ë¥¼ ì£¼ì–´ ìš”ì²­í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ì´ë‹¤.
ì´ì œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ë©´ ì‹¤íŒ¨í•  ê²ƒì´ë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ì— ê°€ì„œ í•´ë‹¹ ê¸°ëŠ¥ì„ êµ¬í˜„í•œë‹¤.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">@RestController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class DashboardController(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val apiSpecRepository: ApiSpecRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @GetMapping(&quot;/api/v1/apis/{page}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fun getRegisteredApis(@PathVariable(&quot;page&quot;) page: Int): List&lt;ApiSpec&gt; = apiSpecRepository.getApis(page)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Getìš”ì²­ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í–ˆìœ¼ë‹ˆ GetMappingì„ êµ¬ì„±í•œë‹¤. Restful ë””ìì¸ì„ ì‚¬ìš©í–ˆë‹¤.
ë‹¤ì‹œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ë©´ í†µê³¼í•œë‹¤.</p></li><li><p>ë°˜ë³µ...</p><p>ì´ì œ ê¸°ëŠ¥ì„ ê°œë°œí•  ë•Œ ë§ˆë‹¤ ìœ„ íë¦„ì„ ë°˜ë³µí•˜ë©´ëœë‹¤. </p><ol><li>Test Case ì‘ì„±<ul><li>JpaRepository<ul><li>ì–´ë–¤ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ì§€ ì •í•œë‹¤.</li><li>Repositoryì— í•´ë‹¹ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥ì˜ ê»ë°ê¸°ë¥¼ ë§Œë“ ë‹¤.</li><li>Repositoryì— JpaRepositoryì˜ Mock-Upì„ ì˜ì¡´ì„±ìœ¼ë¡œ ì£¼ì…í•œë‹¤.</li></ul></li><li>Repository<ul><li>mock-upì—†ì´, ì‹¤ì œ ë°ì´í„°ì˜ CRUDê°€ ì´ë¤„ì§€ëŠ”ì§€ë¥¼ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•œë‹¤.</li></ul></li><li>Controller<ul><li>Repositoryë¡œ êº¼ë‚´ì˜¨ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ í•¸ë“¤ë§ í•  ì§€ì— ëŒ€í•´ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•œë‹¤.</li><li>ì‹¤ì œ Requestì™€ ìœ ì‚¬í•˜ê²Œ í…ŒìŠ¤íŠ¸í•´ì•¼ í•˜ë¯€ë¡œ MockMVCë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤.</li><li>Repositoryì˜ Mock-Upì„ Controllerì˜ ì˜ì¡´ì„±ìœ¼ë¡œ ì£¼ì…í•œë‹¤.</li></ul></li></ul></li><li>Test ìˆ˜í–‰</li><li>Refactoring</li></ol></li></ol></li><li><p>ì•ìœ¼ë¡œ...</p><ol><li>Frontendì™€ Apiì—°ë™.<ul><li>í˜„ì¬ê¹Œì§€ ì‘ì„±ëœ Apië“¤ì„ Frontendì™€ ì—°ë™í•´ ê¸°ëŠ¥ì˜ ë™ì‘ì„ í™•ì¸í•œë‹¤.</li></ul></li><li>CI/CDíˆ´ê³¼ ì—°ë™.<ul><li>Jenkinsë¡œ ë°°ì¹˜ í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬ì„±í•´ í…ŒìŠ¤íŠ¸ë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ, ìë™í™” í•œë‹¤.</li></ul></li></ol></li></ol></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3kfx"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/spring">Spring</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/springboot">Springboot</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/tdd">TDD</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/mockito">Mockito</a></li></ul></div><div class="col margin-top--sm"><a href="https://rhdtl78.github.io/study/2020-07-16-spring-auto-monitor-index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/study/kafka/chapter/03"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« <!-- -->[Kafka] Chapter03. ì¹´í”„ì¹´ ë””ìì¸</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/study/spring/external_configuration"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">ì™¸ë¶€ ì„¤ì •<!-- --> Â»</div></a></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Jeonghun Kong. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a5b0cd21.js"></script>
<script src="/assets/js/main.53cff753.js"></script>
</body>
</html>